<!-- build time:Tue Oct 22 2019 22:49:36 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next mist" lang="zh-Hans"><head><meta charset="UTF-8"><meta name="baidu-site-verification" content="dil57BBbBc"><meta name="google-site-verification" content="YH32omENY7b_BdEuIWv46jSBK-0Vyw_dWbJTGNBblT0"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><meta name="keywords" content="å‡½æ•°å¼ç¼–ç¨‹,"><meta name="description" content="è¯»åæ„Ÿå¾ˆä¹…ä¹‹å‰ï¼Œç»„å†…åˆ†äº«è¿‡å‡½æ•°å¼ç¼–ç¨‹çš„ç›¸å…³å†…å®¹ï¼Œå¬å®Œä¹‹åçš„æ„Ÿå—å°±æ˜¯å’Œæ²¡å¬æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚å‡½æ•°å¼ç¼–ç¨‹ä¸­æœ‰è®¸å¤šæ¦‚å¿µï¼Œå¯¹äºç†Ÿæ‚‰å’Œè§æƒ¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„äººæ¥è¯´ï¼Œä¸€æ—¶åŠä¼šä¸èƒ½å¤Ÿæ¶ˆåŒ–ã€‚è€Œä¸”ï¼Œå°±è¿å€¼å’Œå¼•ç”¨ã€é—­åŒ…ç­‰æ¦‚å¿µéƒ½åˆ†ä¸æ¸…çš„äººï¼Œå¯¹JavaScript å‡½æ•°å¼ç¼–ç¨‹çš„å…¥é—¨æ›´æ˜¯å›°éš¾é‡é‡ã€‚ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹è‡ªç§°æ˜¯è½»é‡çº§çš„ï¼ŒæŠ›å¼€äº†æ¦‚å¿µçš„è®²è§£ï¼Œä»ä¸ºä»€ä¹ˆç”¨ï¼Œæ€ä¹ˆç”¨ï¼Œæœ€ç»ˆå‘ˆç°ä¸ºä»€ä¹ˆç­‰å‡ ä¸ªæ–¹é¢å¸¦æˆ‘ä»¬é‡æ–°è®¤è¯†äº†å‡½"><meta name="keywords" content="å‡½æ•°å¼ç¼–ç¨‹"><meta property="og:type" content="article"><meta property="og:title" content="è¯»ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹"><meta property="og:url" content="https://www.yexiaochen.com/è¯»ã€ŠJavaScript-è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹/index.html"><meta property="og:site_name" content="å¤œæ›‰å®¸"><meta property="og:description" content="è¯»åæ„Ÿå¾ˆä¹…ä¹‹å‰ï¼Œç»„å†…åˆ†äº«è¿‡å‡½æ•°å¼ç¼–ç¨‹çš„ç›¸å…³å†…å®¹ï¼Œå¬å®Œä¹‹åçš„æ„Ÿå—å°±æ˜¯å’Œæ²¡å¬æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚å‡½æ•°å¼ç¼–ç¨‹ä¸­æœ‰è®¸å¤šæ¦‚å¿µï¼Œå¯¹äºç†Ÿæ‚‰å’Œè§æƒ¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„äººæ¥è¯´ï¼Œä¸€æ—¶åŠä¼šä¸èƒ½å¤Ÿæ¶ˆåŒ–ã€‚è€Œä¸”ï¼Œå°±è¿å€¼å’Œå¼•ç”¨ã€é—­åŒ…ç­‰æ¦‚å¿µéƒ½åˆ†ä¸æ¸…çš„äººï¼Œå¯¹JavaScript å‡½æ•°å¼ç¼–ç¨‹çš„å…¥é—¨æ›´æ˜¯å›°éš¾é‡é‡ã€‚ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹è‡ªç§°æ˜¯è½»é‡çº§çš„ï¼ŒæŠ›å¼€äº†æ¦‚å¿µçš„è®²è§£ï¼Œä»ä¸ºä»€ä¹ˆç”¨ï¼Œæ€ä¹ˆç”¨ï¼Œæœ€ç»ˆå‘ˆç°ä¸ºä»€ä¹ˆç­‰å‡ ä¸ªæ–¹é¢å¸¦æˆ‘ä»¬é‡æ–°è®¤è¯†äº†å‡½"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://www.yexiaochen.com/images/FP.png"><meta property="og:image" content="https://www.yexiaochen.com/images/stack_heap.png"><meta property="og:image" content="https://www.yexiaochen.com/images/tailCall.png"><meta property="og:updated_time" content="2019-10-22T14:49:20.514Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="è¯»ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹"><meta name="twitter:description" content="è¯»åæ„Ÿå¾ˆä¹…ä¹‹å‰ï¼Œç»„å†…åˆ†äº«è¿‡å‡½æ•°å¼ç¼–ç¨‹çš„ç›¸å…³å†…å®¹ï¼Œå¬å®Œä¹‹åçš„æ„Ÿå—å°±æ˜¯å’Œæ²¡å¬æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚å‡½æ•°å¼ç¼–ç¨‹ä¸­æœ‰è®¸å¤šæ¦‚å¿µï¼Œå¯¹äºç†Ÿæ‚‰å’Œè§æƒ¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„äººæ¥è¯´ï¼Œä¸€æ—¶åŠä¼šä¸èƒ½å¤Ÿæ¶ˆåŒ–ã€‚è€Œä¸”ï¼Œå°±è¿å€¼å’Œå¼•ç”¨ã€é—­åŒ…ç­‰æ¦‚å¿µéƒ½åˆ†ä¸æ¸…çš„äººï¼Œå¯¹JavaScript å‡½æ•°å¼ç¼–ç¨‹çš„å…¥é—¨æ›´æ˜¯å›°éš¾é‡é‡ã€‚ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹è‡ªç§°æ˜¯è½»é‡çº§çš„ï¼ŒæŠ›å¼€äº†æ¦‚å¿µçš„è®²è§£ï¼Œä»ä¸ºä»€ä¹ˆç”¨ï¼Œæ€ä¹ˆç”¨ï¼Œæœ€ç»ˆå‘ˆç°ä¸ºä»€ä¹ˆç­‰å‡ ä¸ªæ–¹é¢å¸¦æˆ‘ä»¬é‡æ–°è®¤è¯†äº†å‡½"><meta name="twitter:image" content="https://www.yexiaochen.com/images/FP.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!1,onmobile:!0},fancybox:!1,tabs:!0,motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"åšä¸»"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.yexiaochen.com/è¯»ã€ŠJavaScript-è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹/"><title>è¯»ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹ | å¤œæ›‰å®¸</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?ad8db08f31eca01d048b60d4299de095";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">å¤œæ›‰å®¸</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">å¤œæ›‰å®¸ Blog</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>é¦–é¡µ</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>å½’æ¡£</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.yexiaochen.com/è¯»ã€ŠJavaScript-è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="æ›‰å®¸"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpeg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="å¤œæ›‰å®¸"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">è¯»ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-10-19T17:29:16+08:00">2019-10-19 </time><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">æ›´æ–°äº&#58;</span> <time title="æ›´æ–°äº" itemprop="dateModified" datetime="2019-10-22T22:49:20+08:00">2019-10-22 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/è¯»ä¹¦/" itemprop="url" rel="index"><span itemprop="name">è¯»ä¹¦</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span> <span title="å­—æ•°ç»Ÿè®¡">3,431 å­— </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="é˜…è¯»æ—¶é•¿">14 åˆ†é’Ÿ</span></div></div></header><div class="post-body han-init-context" itemprop="articleBody"><h2 id="è¯»åæ„Ÿ"><a href="#è¯»åæ„Ÿ" class="headerlink" title="è¯»åæ„Ÿ"></a>è¯»åæ„Ÿ</h2><p>å¾ˆä¹…ä¹‹å‰ï¼Œç»„å†…åˆ†äº«è¿‡å‡½æ•°å¼ç¼–ç¨‹çš„ç›¸å…³å†…å®¹ï¼Œå¬å®Œä¹‹åçš„æ„Ÿå—å°±æ˜¯å’Œæ²¡å¬æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚å‡½æ•°å¼ç¼–ç¨‹ä¸­æœ‰è®¸å¤šæ¦‚å¿µï¼Œå¯¹äºç†Ÿæ‚‰å’Œè§æƒ¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„äººæ¥è¯´ï¼Œä¸€æ—¶åŠä¼šä¸èƒ½å¤Ÿæ¶ˆåŒ–ã€‚è€Œä¸”ï¼Œå°±è¿å€¼å’Œå¼•ç”¨ã€é—­åŒ…ç­‰æ¦‚å¿µéƒ½åˆ†ä¸æ¸…çš„äººï¼Œå¯¹JavaScript å‡½æ•°å¼ç¼–ç¨‹çš„å…¥é—¨æ›´æ˜¯å›°éš¾é‡é‡ã€‚ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹è‡ªç§°æ˜¯è½»é‡çº§çš„ï¼ŒæŠ›å¼€äº†æ¦‚å¿µçš„è®²è§£ï¼Œä»ä¸ºä»€ä¹ˆç”¨ï¼Œæ€ä¹ˆç”¨ï¼Œæœ€ç»ˆå‘ˆç°ä¸ºä»€ä¹ˆç­‰å‡ ä¸ªæ–¹é¢å¸¦æˆ‘ä»¬é‡æ–°è®¤è¯†äº†å‡½æ•°è¿™ä¸ªåŸºç¡€ä¸”é‡è¦çš„æ¦‚å¿µã€‚</p><h2 id="ä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹"><a href="#ä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="ä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹"></a>ä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹</h2><p>å½“ä¸‹æœ‰ä¸‰ç§ç¼–ç¨‹èŒƒå¼ï¼Œç»“æ„åŒ–ç¼–ç¨‹ã€é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹ã€‚è™½ç„¶å‡½æ•°å¼ç¼–ç¨‹æ˜¯è¿‘äº›å¹´æ‰é‡‡ç”¨çš„ç¼–ç¨‹èŒƒå¼ï¼Œä½†æ˜¯å®ƒçš„å‘æ˜å´æ˜¯æœ€æ—©çš„ã€‚å‡½æ•°å¼ç¼–ç¨‹æ¦‚å¿µæ˜¯åŸºäº ğ›Œ æ¼”ç®—çš„ç›´æ¥è¡ç”Ÿç‰©ã€‚ğ›Œ æ¼”ç®—æ³•çš„ä¸€ä¸ªæ ¸å¿ƒæ€æƒ³æ˜¯ä¸å˜æ€§ï¼Œæ•…ï¼Œç†è®ºä¸Šè®²ï¼Œåœ¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­åº”è¯¥ä¸å­˜åœ¨èµ‹å€¼è¯­å¥çš„ã€‚</p><p>å‡½æ•°å¼ç¼–ç¨‹çš„åŸåˆ™å¯ä»¥ä½¿å¾—æˆ‘ä»¬å†™å‡ºçš„ä»£ç æ˜¯å¯è¯»ã€å¯ä¿¡ä»»çš„ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨å®ƒæ˜¯å®¹æ˜“ç†è§£çš„ã€‚å£°æ˜å¼çš„é£æ ¼å¯ä»¥è®©æˆ‘ä»¬çŸ¥é“ç¨‹åºæ˜¯å¹²ä»€ä¹ˆçš„ï¼Œä½†æ˜¯è¦å†™å‡ºè¿™æ ·çš„ç¨‹åºå´ä¸æ˜¯å¾ˆå®¹æ˜“ç†è§£çš„ï¼Œèµ·ç å¯¹äºåˆšæ¥è§¦å‡½æ•°å¼ç¼–ç¨‹çš„äººæ¥è¯´ã€‚</p><p>åœ¨ç»´æŠ¤ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¤§éƒ¨åˆ†æ—¶é—´æ˜¯ç”¨æ¥é˜…è¯»å’Œç†è§£ä»£ç ã€‚æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å°å¿ƒç¿¼ç¿¼åœ°é˜…è¯»æ¯ä¸€è¡Œä»£ç ï¼Œç”Ÿæ€•æŸä¸€ä¸ªä¸ä¸ºäººçŸ¥çš„éªšæ“ä½œä¼šå¼•å‘äº†ä¸€äº›åˆ—çš„ bugï¼›æœ‰æ—¶å€™ä¹Ÿéœ€è¦åœ¨ä¸åŒå‡½æ•°è°ƒç”¨ä¸­äº†è§£ç¨‹åºçš„æ„å›¾ã€‚æ€»ä¹‹ï¼Œå‡½æ•°å¼ç¼–ç¨‹çš„ä¸€äº›åŸåˆ™å¯ä»¥è®©æˆ‘ä»¬å†™å‡ºå¯è¯»æ€§é«˜ã€å¯éªŒè¯çš„ä»£ç ã€‚å½“ç„¶ï¼Œå³ä¾¿æŒæ¡äº†å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¹Ÿå¹¶ä¸æ„å‘³ç€ä½ ä¸€å®šå¾—ç”¨å®ƒã€‚</p><blockquote><p>æœ€å¥½çš„ä»£ç æ˜¯å¯è¯»æ€§é«˜çš„ä»£ç ï¼Œå› ä¸ºå®ƒåœ¨æ­£ç¡®çš„ï¼ˆç†æƒ³ä¸»ä¹‰ï¼‰å’Œå¿…ç„¶çš„ï¼ˆæ­£ç¡®çš„ï¼‰ä¹‹é—´å¯»æ±‚åˆ°äº†æ°åˆ°å¥½å¤„çš„å¹³è¡¡ã€‚</p></blockquote><center><br><br><img src="../images/FP.png" alt="FP"><br><br></center><h2 id="å‡½æ•°åŸºç¡€"><a href="#å‡½æ•°åŸºç¡€" class="headerlink" title="å‡½æ•°åŸºç¡€"></a>å‡½æ•°åŸºç¡€</h2><p>åœ¨æ•°å­¦ä¸­ï¼Œå‡½æ•°æ€»æ˜¯è·å–ä¸€äº›è¾“å…¥å€¼ï¼Œç„¶åè¿”å›ä¸€ä¸ªè¾“å‡ºå€¼ï¼Œè¾“å…¥å€¼å’Œè¾“å‡ºå€¼å­˜åœ¨æŸç§å…³ç³»çš„æ˜ å°„ã€‚åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ä½¿ç”¨çš„å°±æ˜¯æ•°å­¦æ„ä¹‰ä¸Šçš„å‡½æ•°ï¼Œæ¥å—è¾“å…¥å€¼ï¼Œæ˜ç¡® <code>return</code> å€¼ã€‚</p><p>å‡½æ•°é€šå¸¸æ˜¯è¿™ä¸ªæ¨¡æ ·ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y, z</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//  ...</span></span><br><span class="line">    &#125;</span><br><span class="line">foo.length  <span class="comment">// 3</span></span><br><span class="line">foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure><p><code>foo.length</code> æ˜¯å‡½æ•°æœŸæœ›çš„å‚æ•°ä¸ªæ•°ï¼Œé€šå¸¸å°±æ˜¯å½¢åƒä¸ªæ•°ã€‚ä½†æ˜¯ï¼Œå¹¶ä¸è¦æ±‚å®å‚å’Œå½¢åƒçš„ä¸ªæ•°ç›¸åŒï¼Œåœ¨å‡½æ•°å†…éƒ¨å¯ä»¥é€šè¿‡ <code>arguments</code> æŸ¥çœ‹æ‰€æœ‰å…¥åƒï¼ˆç®­å¤´å‡½æ•°æ— æ­¤å‚æ•°ï¼‰ã€‚</p><p>ä½¿ç”¨ ES6 ä¸­çš„è§£æ„å¯ä»¥è½»æ¾ç»™å˜é‡ç»‘å®šå…¥åƒçš„å€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">[x, y, ...args]</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = params[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> y = params[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">var</span> args = params.slice(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">//  ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±ä»¥ä¸Šå¯¹æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå£°æ˜å¼ä»£ç é€šå¸¸æ¯”å‘½ä»¤å¼ä»£ç æ›´å¹²å‡€ã€‚æ‰€ä»¥åªè¦æœ‰å¯èƒ½ï¼Œè¿˜æ˜¯å°½å¯èƒ½ä½¿ç”¨å£°æ˜å¼å’Œè‡ªè§£é‡Šçš„ä»£ç ã€‚</p><p>æœ‰æ—¶å€™å‡½æ•°ä¼šæ ¹æ®ä¸åŒçš„è¾“å…¥å€¼æ¥é‡è½½ä¸åŒçš„åŠŸèƒ½ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x,y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> x == <span class="string">"number"</span> &amp;&amp; <span class="keyword">typeof</span> y == <span class="string">"number"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x * y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§è®¾è®¡è™½ç„¶æš‚æ—¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å¯¹ä»¥åçš„åŠŸèƒ½æ·»åŠ æˆ–ä¿®æ”¹ä¼šå¸¦æ¥å¾ˆå¤§çš„éº»çƒ¦ã€‚</p><p>åœ¨ä¸Šé¢å·²ç»æåˆ°å‡½æ•°è¦æœ‰æ˜ç¡®çš„ <code>return</code> å€¼ï¼Œå¦‚æœå‡½æ•°å†…éƒ¨æ”¹å˜äº†å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡æˆ–å¼•ç”¨ç±»å‹çš„å…¥åƒï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±æœ‰äº†å‰¯ä½œç”¨çš„ï¼Œå¯¹è¯¥å‡½æ•°å¤–çš„ç¯å¢ƒé€ æˆäº†æ±¡æŸ“ã€‚æˆ‘ä»¬å¸Œæœ›å‡½æ•°æ˜¯ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œå³çº¯å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">list</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!list[i]) list[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        total = total + list[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nums = [ <span class="number">1</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">27</span>, , <span class="number">84</span> ];</span><br><span class="line"></span><br><span class="line">sum( nums );            <span class="comment">// 124</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°å¯ä»¥æ¥å—å¹¶è¿”å›ä»»ä½•ç±»å‹çš„å€¼ï¼Œå½“è¿™ç§ç±»å‹çš„å€¼æ°å¥½æ˜¯å‡½æ•°æ—¶ï¼Œå®ƒå°±å«é«˜é˜¶å‡½æ•°ã€‚è€ŒçœŸæ­£é«˜é˜¶çš„ç”¨æ³•ï¼Œå°±æ˜¯é—­åŒ…ï¼Œå®ƒå¯ä»¥è®°å½•å¹¶ä¸”è®¿é—®ä½œç”¨äºå¤–çš„å˜é‡ï¼Œç”šè‡³è¯¥å‡½æ•°åœ¨ä¸åŒä½œç”¨åŸŸä¸­è¢«æ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runningCounter</span>(<span class="params">start</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> val = start;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">current</span>(<span class="params">increment = <span class="number">1</span></span>)</span>&#123;</span><br><span class="line">        val = val + increment;</span><br><span class="line">        <span class="keyword">return</span> val;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> score = runningCounter( <span class="number">0</span> );</span><br><span class="line"></span><br><span class="line">score();                <span class="comment">// 1</span></span><br><span class="line">score();                <span class="comment">// 2</span></span><br><span class="line">score( <span class="number">13</span> );            <span class="comment">// 15</span></span><br></pre></td></tr></table></figure><p>é—­åŒ…ä¸­ä¿å­˜çš„å˜é‡å¹¶ä¸ä¼šåœ¨å‡½æ•°æ‰§è¡Œåè‡ªåŠ¨é”€æ¯ï¼Œåªè¦å†…éƒ¨å‡½æ•°ä¾ç„¶å­˜åœ¨å¯¹å˜é‡çš„å¼•ç”¨ï¼Œå˜é‡å°±ä¼šä¸€ç›´ä¿ç•™ã€‚åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œé—­åŒ…æ˜¯æœ€é‡è¦çš„åŸºç¡€ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ¦‚å¿µä¸€å®šè¦ç†è§£ã€‚</p><p>è¿˜æœ‰çš„å‡½æ•°æ˜¯æ²¡æœ‰åå­—çš„ï¼Œè¿™ç§å‡½æ•°ç§°ä¹‹ä¸ºåŒ¿åå‡½æ•°ï¼Œä½¿ç”¨æœ€å¤šçš„æ˜¯ç«‹å³æ‰§è¡Œè¡¨è¾¾å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆ‘æ˜¯ IIFE!</span></span><br><span class="line"></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>å‘½åå‡½æ•°çš„å¥½å¤„æœ‰å¾ˆå¤šï¼Œå¯ä»¥åœ¨å †æ ˆä¸­æ–¹ä¾¿è°ƒè¯•ï¼Œå¯ä»¥é€šè¿‡åå­—å¼•ç”¨è‡ªèº«ç­‰ã€‚ä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å‡½æ•°éƒ½å¯ä»¥å‘½åçš„ï¼Œç®­å¤´å‡½æ•°å¯ä»¥è¯´æ˜¯ååˆ†ç®€æ´ï¼Œå¯ä»¥ä½¿ç”¨æœ€ç®€å•çš„ç¬¦å·æ¥è¡¨ç¤ºä¸€ä¸ªå‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">people.map( <span class="function"><span class="params">person</span> =&gt;</span> person.nicknames[<span class="number">0</span>] || person.firstName );</span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°é™¤äº†å†™æ³•ç®€æ´ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯ä»¥ç§°ä¹‹ä¸ºå¥½å¤„çš„ä¾¿æ˜¯ <code>this</code>ã€‚ç®­å¤´å‡½æ•°ä¸­çš„ <code>this</code> æ˜¯åŸºäºä½œç”¨åŸŸçš„ï¼Œæ˜¯å¯ä»¥é¢„æµ‹çš„ã€‚è€Œå¯¹äºæ™®é€šå‡½æ•°ï¼Œ<code>this</code> æ˜¯åŠ¨æ€ç»‘å®šçš„ï¼Œæ˜¯åŸºäºè°ƒç”¨è€…çš„ã€‚ä¸ç®¡æ˜¯å“ªä¸€ç§ <code>this</code>ï¼Œ æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›èƒ½å¤Ÿæ˜¾å¼åœ°è¡¨ç¤ºä¸Šä¸‹æ–‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">ctx</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ctx.x + ctx.y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> context = &#123;</span><br><span class="line">    x: <span class="number">1</span>,</span><br><span class="line">    y: <span class="number">2</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">sum( context );</span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°çš„è¾“å…¥"><a href="#å‡½æ•°çš„è¾“å…¥" class="headerlink" title="å‡½æ•°çš„è¾“å…¥"></a>å‡½æ•°çš„è¾“å…¥</h2><p>åœ¨ç¨‹åºä¸­å¾€å¾€å°†ä¸å˜çš„å°è£…èµ·æ¥ï¼Œå˜åŒ–çš„éš”ç¦»å¼€æ¥ã€‚å¾ˆå¤šæ—¶å€™ä¸å˜çš„åŒ…æ‹¬ä¸€äº›é¢„è®¾çš„å‚æ•°ã€‚</p><p>é¦–å…ˆå°è£…ä¸€ä¸ªè¯·æ±‚å‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­¥éª¤ä¸€ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">url,data,callback</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ..</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸åŒçš„è¯·æ±‚ï¼Œæœ‰ä¸åŒçš„ url æˆ–å‚æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­¥éª¤äºŒï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPerson</span>(<span class="params">data,cb</span>) </span>&#123;</span><br><span class="line">    ajax( <span class="string">"http://some.api/person"</span>, data, cb );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getOrder</span>(<span class="params">data,cb</span>) </span>&#123;</span><br><span class="line">    ajax( <span class="string">"http://some.api/order"</span>, data, cb );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>url å°±æ˜¯é¢„è®¾çš„å‚æ•°ï¼Œè€Œå‰©ä½™çš„å‚æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ä¼ å…¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­¥éª¤ä¸‰ï¼š</span></span><br><span class="line">getPerson( &#123; <span class="attr">user</span>: CURRENT_USER_ID &#125;, cb );</span><br></pre></td></tr></table></figure><p>ä»”ç»†è§‚å¯Ÿæ­¥éª¤äºŒï¼Œä»£ç ä¼¼ä¹è¿˜å¯ä»¥æç‚¼ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­¥éª¤äºŒï¼š</span></span><br><span class="line"><span class="keyword">var</span> partial = <span class="function">(<span class="params">fn, ...presetArgs</span>) =&gt;</span></span><br><span class="line">                (...laterArgs) =&gt; </span><br><span class="line">                    fn(...presetArgs, ...laterArgs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getPerson = partial(ajax, <span class="string">"http://some.api/person"</span>);</span><br><span class="line"><span class="keyword">var</span> getOrder = partial(ajax, <span class="string">"http://some.api/order"</span>);</span><br></pre></td></tr></table></figure><p>æ­¥éª¤äºŒçš„è½¬æ¢å°±æ˜¯åå‡½æ•°çš„åº”ç”¨ï¼Œå®ƒæ˜¯é€šè¿‡é¢„è®¾å‚æ•°çš„æ–¹å¼æ¥å‡å°‘å…¥åƒçš„æ•°é‡ã€‚å¦‚æœé¢ å€’å…¥åƒçš„é¡ºåºï¼Œå°±æˆäº†å³åå‡½æ•°ã€‚</p><p>åŒæ ·æ˜¯å¯¹å‡½æ•°è¾“å…¥ç®¡ç†çš„æŠ€æœ¯ï¼Œå³æŸ¯é‡ŒåŒ–ï¼Œè¯¥æŠ€æœ¯å°†ä¸€ä¸ªæ¥å—å¤šä¸ªå®å‚çš„å‡½æ•°æ‹†è§£æˆè¿ç»­çš„é“¾å¼å‡½æ•°ï¼Œæ¯ä¸ªé“¾å¼å‡½æ•°æ¥å—å•ä¸€å®å‚å¹¶è¿”å›æ¥å—ä¸‹ä¸€ä¸ªå®å‚çš„å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">        sum += args[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> ); </span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¯é‡ŒåŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> curry =</span><br><span class="line">    (fn, arity = fn.length, nextCurried) =&gt;</span><br><span class="line">        (nextCurried = <span class="function"><span class="params">prevArgs</span> =&gt;</span></span><br><span class="line">            nextArg =&gt; &#123;</span><br><span class="line">                <span class="keyword">var</span> args = prevArgs.concat( [nextArg] );</span><br><span class="line">                <span class="keyword">if</span> (args.length &gt;= arity) &#123;</span><br><span class="line">                    <span class="keyword">return</span> fn( ...args );</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> nextCurried( args );</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        )( [] );</span><br><span class="line"></span><br><span class="line"><span class="comment">// (5 ç”¨æ¥æŒ‡å®šéœ€è¦é“¾å¼è°ƒç”¨çš„æ¬¡æ•°)</span></span><br><span class="line"><span class="keyword">var</span> curriedSum = curry( sum, <span class="number">5</span> );</span><br><span class="line">curriedSum( <span class="number">1</span> )( <span class="number">2</span> )( <span class="number">3</span> )( <span class="number">4</span> )( <span class="number">5</span> );</span><br></pre></td></tr></table></figure><p>ä»ä»¥ä¸Šçš„ä»£ç å¯ä»¥å‘ç°ï¼Œæ— è®ºæ˜¯åå‡½æ•°è¿˜æ˜¯æŸ¯é‡ŒåŒ–ï¼Œéƒ½æ˜¯æ”¶é½æ‰€æœ‰çš„å®å‚åæ‰æ‰§è¡ŒåŸå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡å¿…è¦ä¸€æ¬¡æ€§ä¼ å…¥æ‰€æœ‰çš„å‚æ•°ï¼Œè€Œä¸”æŸ¯é‡ŒåŒ–è¿™ç§åªæ¥å—å•ä¸€å‚æ•°çš„ç‰¹æ€§åœ¨åé¢çš„ç»„åˆå‡½æ•°ä¸­ä¹Ÿèµ·ç€å¾ˆé‡è¦çš„ä½œç”¨ã€‚</p><p>å‡½æ•°å¼ç¼–ç¨‹å¯ä»¥è¯´åœ¨å‚æ•°ä¸Šä¸‹äº†å¾ˆå¤§çš„åŠŸå¤«ï¼Œç”šè‡³è¿˜æœ‰ç§ç§°ä¹‹ä¸ºæ— å½¢åƒçš„é£æ ¼ï¼Œå…¶ç›®çš„å°±æ˜¯ç§»é™¤éå¿…è¦çš„å½¢åƒåˆ°å®å‚ä¹‹é—´çš„æ˜ å°„ã€‚æ— å½¢åƒé£æ ¼æ˜¯å¦æé«˜äº†ä»£ç çš„å¯è¯»æ€§ï¼Œæœ‰æ²¡æœ‰å¿…è¦ä½¿ç”¨æ— å½¢åƒé£æ ¼ï¼Œè¿˜éœ€è¦ä½ è‡ªå·±å»å®šå¤ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">double</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].map( <span class="function"><span class="keyword">function</span> <span class="title">mapper</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> double( v );</span><br><span class="line">&#125; );</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— å½¢åƒé£æ ¼ï¼›</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].map( double );</span><br></pre></td></tr></table></figure><h2 id="ç»„åˆå‡½æ•°"><a href="#ç»„åˆå‡½æ•°" class="headerlink" title="ç»„åˆå‡½æ•°"></a>ç»„åˆå‡½æ•°</h2><p>å‡½æ•°ç»„åˆï¼Œå°±æ˜¯æŠŠä¸Šä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºå€¼ä½œä¸ºä¸‹ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥å€¼ï¼Œå¹¶ä»¥æ­¤æŒç»­ä¸‹å»ã€‚</p><p>çœ‹ä¸ªä¾‹å­ï¼Œå°†ä¸€å¥è¯æ‹†åˆ†ä¸ºå•è¯æ•°ç»„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è½¬å°å†™ï¼Œè¿‡è™‘å‡ºå•è¯ï¼›</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">words</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>( str )</span><br><span class="line">        .toLowerCase()</span><br><span class="line">        .split( <span class="regexp">/\s|\b/</span> )</span><br><span class="line">        .filter( <span class="function"><span class="keyword">function</span> <span class="title">alpha</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="regexp">/^[\w]+$/</span>.test( v );</span><br><span class="line">        &#125; );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å»é‡ï¼›</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">list</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> uniqList = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">        <span class="comment">// value not yet in the new list?</span></span><br><span class="line">        <span class="keyword">if</span> (uniqList.indexOf( list[i] ) === <span class="number">-1</span> ) &#123;</span><br><span class="line">            uniqList.push( list[i] );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> uniqList;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> text = <span class="string">"To compose two functions together, pass the \</span></span><br><span class="line"><span class="string">output of the first function call as the input of the \</span></span><br><span class="line"><span class="string">second function call."</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueWords</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> unique( words( str ) );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wordsUsed = uniqueWords(text);</span><br><span class="line"><span class="comment">// ["to","compose","two","functions","together","pass",</span></span><br><span class="line"><span class="comment">// "the","output","of","first","function","call","as",</span></span><br><span class="line"><span class="comment">// "input","second"]</span></span><br></pre></td></tr></table></figure><p>æ•°æ®çš„æµå‘ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wordsUsed &lt;-- unique &lt;-- words &lt;-- text</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å‡½æ•°å¼ç¼–ç¨‹å–œæ¬¢å£°æ˜å¼é£æ ¼ï¼Œå…³æ³¨ç‚¹åœ¨æ˜¯ä»€ä¹ˆè€Œä¸æ˜¯æ€ä¹ˆåšï¼Œæˆ‘ä»¬ä¸éœ€è¦çŸ¥é“å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚æˆ‘ä»¬å¸Œæœ›æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘½ä»¤å¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shorterWords</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> skipLongWords( unique( words( text ) ) );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜å¼</span></span><br><span class="line"><span class="keyword">var</span> shorterWords = compose( skipLongWords, unique, words );</span><br></pre></td></tr></table></figure><p>å¦‚ä½•å®ç°å‡½æ•° <code>compose</code> ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†™æ³•ä¸€ï¼š</span></span><br><span class="line"><span class="keyword">var</span> compose =</span><br><span class="line">    (...fns) =&gt;</span><br><span class="line">        result =&gt; &#123;</span><br><span class="line">            <span class="keyword">var</span> list = fns.slice();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (list.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// å°†æœ€åä¸€ä¸ªå‡½æ•°ä»åˆ—è¡¨å°¾éƒ¨æ‹¿å‡º</span></span><br><span class="line">                <span class="comment">// å¹¶æ‰§è¡Œå®ƒ</span></span><br><span class="line">                result = list.pop()( result );</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•äºŒï¼š</span></span><br><span class="line"><span class="keyword">var</span> compose =</span><br><span class="line">    (...fns) =&gt;</span><br><span class="line">        fns.reverse().reduce( <span class="function">(<span class="params">fn1,fn2</span>) =&gt;</span></span><br><span class="line">            (...args) =&gt;</span><br><span class="line">                fn2( fn1( ...args ) )</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•ä¸‰ï¼š</span></span><br><span class="line"><span class="keyword">var</span> compose =</span><br><span class="line">    (...fns) =&gt; &#123;</span><br><span class="line">        <span class="comment">// æ‹¿å‡ºæœ€åä¸¤ä¸ªå‚æ•°</span></span><br><span class="line">        <span class="keyword">var</span> [ fn1, fn2, ...rest ] = fns.reverse();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> composedFn =</span><br><span class="line">            (...args) =&gt;</span><br><span class="line">                fn2( fn1( ...args ) );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rest.length == <span class="number">0</span>) <span class="keyword">return</span> composedFn;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> compose( ...rest.reverse(), composedFn );</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><h2 id="å‰¯ä½œç”¨ä¸å€¼çš„ä¸å¯å˜æ€§"><a href="#å‰¯ä½œç”¨ä¸å€¼çš„ä¸å¯å˜æ€§" class="headerlink" title="å‰¯ä½œç”¨ä¸å€¼çš„ä¸å¯å˜æ€§"></a>å‰¯ä½œç”¨ä¸å€¼çš„ä¸å¯å˜æ€§</h2><h2 id="é—­åŒ…å’Œå¯¹è±¡"><a href="#é—­åŒ…å’Œå¯¹è±¡" class="headerlink" title="é—­åŒ…å’Œå¯¹è±¡"></a>é—­åŒ…å’Œå¯¹è±¡</h2><p>é¦–å…ˆç”¨ä¸¤æ®µä»£ç æ¥æè¿°åŒä¸€ä¸ªä¸œè¥¿ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é—­åŒ…æ–¹å¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">person</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> happyBirthday()&#123;</span><br><span class="line">        age++;</span><br><span class="line">        <span class="built_in">console</span>.log(</span><br><span class="line">            <span class="string">"Happy "</span> + age + <span class="string">"th Birthday, "</span> + name + <span class="string">"!"</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> birthdayBoy = person( <span class="string">"Kyle"</span>, <span class="number">36</span> );</span><br><span class="line">birthdayBoy();            <span class="comment">// Happy 37th Birthday, Kyle!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹è±¡æ–¹å¼</span></span><br><span class="line"><span class="keyword">var</span> birthdayBoy = &#123;</span><br><span class="line">    name: <span class="string">"Kyle"</span>,</span><br><span class="line">    age: <span class="number">36</span>,</span><br><span class="line">    happyBirthday() &#123;</span><br><span class="line">        <span class="keyword">this</span>.age++;</span><br><span class="line">        <span class="built_in">console</span>.log(</span><br><span class="line">            <span class="string">"Happy "</span> + <span class="keyword">this</span>.age + <span class="string">"th Birthday, "</span> + <span class="keyword">this</span>.name + <span class="string">"!"</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">birthdayBoy.happyBirthday();</span><br><span class="line"><span class="comment">// Happy 37th Birthday, Kyle!</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°é—­åŒ…å’Œå¯¹è±¡å°±æ˜¯å¯¹åŒä¸€äº‹ç‰©çš„ä¸¤ç§è¡¨è¾¾æ–¹å¼ã€‚</p><p>å…³äºé—­åŒ…å’Œå¯¹è±¡æœ‰ç€ä»¥ä¸‹çš„è®ºè°ƒï¼š</p><ol><li>ä¸€ä¸ªæ²¡æœ‰é—­åŒ…çš„ç¼–ç¨‹è¯­è¨€å¯ä»¥ç”¨å¯¹è±¡æ¥æ¨¡æ‹Ÿé—­åŒ…ã€‚</li><li>ä¸€ä¸ªæ²¡æœ‰å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€å¯ä»¥ç”¨è¡¨æŠ¥æ¨¡æ‹Ÿå¯¹è±¡ã€‚</li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ JavaScript ä¸­ç”¨å¯¹è±¡æ¨¡æ‹Ÿé—­åŒ…ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">inner</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè¦è§£å†³ <code>outer()</code> æ‰§è¡Œåï¼Œ<code>x</code> å˜é‡æ²¡æœ‰è¢«é”€æ¯ã€‚åœ¨åˆ›å»ºå‡½æ•° <code>outer</code> æ—¶ï¼Œæœ‰ä¸ªå¯¹è±¡ä¼šä¿å­˜è¯¥ä½œç”¨åŸŸä¸‹çš„æ‰€æœ‰å˜é‡:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scopeOfOuter = &#123;</span><br><span class="line">    x: <span class="number">1</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºå‡½æ•° <code>inner</code> æ—¶ï¼Œä¹Ÿä¼šç”Ÿæˆä¸€ä¸ª <code>scopeOfInner</code> çš„ä½œç”¨åŸŸå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„åŸå‹æŒ‡å‘ <code>scopeOfOuter</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scopeOfInner = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf( scopeOfInner, scopeOfOuter );</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åœ¨è®¿é—® x å˜é‡æ—¶ï¼Œæ›´åƒæ˜¯åœ¨è®¿é—® scopeOfInner.xï¼Œç„¶åæ²¿åŸå‹é“¾æŸ¥æ‰¾ã€‚</p><p>ä»¥ä¸Šåªæ˜¯äº›å‡è®¾ï¼ŒçœŸå®çš„æƒ…å†µè‚¯å®šæ¯”è¿™å¤æ‚ã€‚è¿™é‡Œåªæ˜¯è®ºè¯å¯ä»¥ä½¿ç”¨å¯¹è±¡å®ç°é—­åŒ…ï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨é—­åŒ…å®ç°å¯¹è±¡ã€‚</p><h2 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h2><p>é€’å½’å¯ä»¥è¯´æ˜¯å¾ˆå‡½æ•°å¼ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯æ›´å…·æœ‰å£°æ˜è¡Œï¼Œç®€æ´æ˜“è¯»ï¼Œä½†æœ€å¤§çš„å¼Šç«¯è¿˜æ˜¯å†…å­˜å ç”¨æ–¹é¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> z = <span class="string">"foo!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="string">"bar!"</span>;</span><br><span class="line">    foo();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">"baz!"</span>;</span><br><span class="line">    bar();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">baz();</span><br></pre></td></tr></table></figure><p>æ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½å°†å¼€è¾Ÿå‡ºä¸€å°å—ç§°ä¸ºå †æ ˆå¸§çš„å†…å­˜ã€‚å †æ ˆå¸§ä¸­åŒ…å«äº†å‡½æ•°è¯­å¥å½“å‰çŠ¶æ€çš„æŸäº›é‡è¦ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»»æ„å˜é‡çš„å€¼ã€‚ä¹‹æ‰€ä»¥è¿™æ ·ï¼Œæ˜¯å› ä¸ºä¸€ä¸ªå‡½æ•°æš‚åœå»æ‰§è¡Œå¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œè€Œå¦å¤–ä¸€ä¸ªå‡½æ•°è¿è¡Œç»“æŸåï¼Œå¼•æ“éœ€è¦è¿”å›åˆ°ä¹‹å‰æš‚åœæ—¶å€™çš„çŠ¶æ€ç»§ç»­æ‰§è¡Œã€‚</p><center><br><br><img src="../images/stack_heap.png" alt="stack_heap"><br><br></center><p>ä½†æ˜¯å¯¹äºé€’å½’æ¥è¯´ï¼Œå¯èƒ½ä¼šç”Ÿæˆä¸Šä¸‡çš„å †æ ˆï¼Œæœ€ç»ˆä¼šå¯¼è‡´çˆ†æ ˆã€‚</p><p>æˆ‘ä»¬å¸Œæœ›å†…å±‚å‡½æ•°åœ¨å‡½æ•°åº•éƒ¨è°ƒç”¨æ—¶ï¼Œå¤–éƒ¨å‡½æ•°çš„å †æ ˆç›´æ¥å¼¹å‡ºã€‚</p><center><br><br><img src="../images/tailCall.png" alt="tailCall"><br><br></center><p>è¿™ç§æŠ€æœ¯å«åšå°¾è°ƒç”¨ä¼˜åŒ–ã€‚</p><p>å‡å°‘å†…å­˜çš„æ–¹æ³•è¿˜åŒ…æ‹¬åç»§ä¼ é€’é£æ ¼ï¼ˆCPSï¼‰å’Œ Trampoline ç­‰ã€‚</p><blockquote><p>åˆ©ç”¨CPSå˜æ¢ï¼ŒæŠŠä»»æ„é€’å½’å‡½æ•°æ”¹å†™æˆå°¾è°ƒç”¨å½¢å¼ï¼Œä»¥ continuation é“¾çš„å½¢å¼ï¼Œå°†é€’å½’å ç”¨çš„æ ˆç©ºé—´è½¬ç§»åˆ°å †ä¸Šï¼Œé¿å…çˆ†æ ˆçš„æ‚²å‰§ã€‚</p></blockquote><blockquote><p>åœ¨ç¼ºä¹å°¾è°ƒç”¨ä¼˜åŒ–çš„è¯­è¨€ä¸­ï¼Œå¹¶ä¸çŸ¥æ™“å‡½æ•°ä¸ä¼šè¿”å›ï¼ŒçŠ¶æ€ã€å‚æ•°å‹æ ˆä¾æ—§ä¼šå‘ç”Ÿï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨å¼ºåˆ¶å¼¹å‡ºä¸‹ä¸€å±‚è°ƒç”¨çš„å‡½æ•°ï¼Œç¦æ­¢è§£é‡Šå™¨çš„å‹æ ˆè¡Œä¸ºï¼Œè¿™å°±æ˜¯æ‰€è°“çš„Trampolineã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–æ³¢é‚£å¥‘</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fib</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> n;</span><br><span class="line">    <span class="keyword">return</span> fib( n - <span class="number">2</span> ) + fib( n - <span class="number">1</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  CPS</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fib</span>(<span class="params">n,cont = r =&gt; r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> cont( n );</span><br><span class="line">    <span class="keyword">return</span> fib(</span><br><span class="line">        n - <span class="number">2</span>,</span><br><span class="line">        n2 =&gt; fib(</span><br><span class="line">            n - <span class="number">1</span>,</span><br><span class="line">            n1 =&gt; cont( n2 + n1 )</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trampoline</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">trampolined</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> result = fn( ...args );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">typeof</span> result == <span class="string">"function"</span>) &#123;</span><br><span class="line">            result = result();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// trampoline åŒ–</span></span><br><span class="line">trampoline(fib(n,cont = <span class="function"><span class="params">r</span> =&gt;</span> r) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> cont( n );</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> fib(</span><br><span class="line">        n - <span class="number">2</span>,</span><br><span class="line">        n2 =&gt; fib(</span><br><span class="line">            n - <span class="number">1</span>,</span><br><span class="line">            n1 =&gt; cont( n2 + n1 )</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:center;color:#555;font-size:18px">------------- The End -------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong> æ›‰å®¸</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://www.yexiaochen.com/è¯»ã€ŠJavaScript-è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹/" title="è¯»ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹">https://www.yexiaochen.com/è¯»ã€ŠJavaScript-è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/å‡½æ•°å¼ç¼–ç¨‹/" rel="tag"><i class="fa fa-tag"></i> å‡½æ•°å¼ç¼–ç¨‹</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/è¯»ã€Šä¹Œåˆä¹‹ä¼—ã€‹/" rel="next" title="è¯»ã€Šä¹Œåˆä¹‹ä¼—ã€‹"><i class="fa fa-chevron-left"></i> è¯»ã€Šä¹Œåˆä¹‹ä¼—ã€‹</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div onclick="showGitment()" id="gitment-display-button">æ˜¾ç¤ºè¯„è®º</div><div id="gitment-container" style="display:none"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">ç«™ç‚¹æ¦‚è§ˆ</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.jpeg" alt="æ›‰å®¸"><p class="site-author-name" itemprop="name">æ›‰å®¸</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">61</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">13</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">109</span> <span class="site-state-item-name">æ ‡ç­¾</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:2277438436@qq.com" target="_blank" title="E-Mail" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#è¯»åæ„Ÿ"><span class="nav-number">1.</span> <span class="nav-text">è¯»åæ„Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹"><span class="nav-number">2.</span> <span class="nav-text">ä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡½æ•°åŸºç¡€"><span class="nav-number">3.</span> <span class="nav-text">å‡½æ•°åŸºç¡€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡½æ•°çš„è¾“å…¥"><span class="nav-number">4.</span> <span class="nav-text">å‡½æ•°çš„è¾“å…¥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç»„åˆå‡½æ•°"><span class="nav-number">5.</span> <span class="nav-text">ç»„åˆå‡½æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‰¯ä½œç”¨ä¸å€¼çš„ä¸å¯å˜æ€§"><span class="nav-number">6.</span> <span class="nav-text">å‰¯ä½œç”¨ä¸å€¼çš„ä¸å¯å˜æ€§</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é—­åŒ…å’Œå¯¹è±¡"><span class="nav-number">7.</span> <span class="nav-text">é—­åŒ…å’Œå¯¹è±¡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é€’å½’"><span class="nav-number">8.</span> <span class="nav-text">é€’å½’</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">æ›‰å®¸</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><style>a.gitment-editor-footer-tip{display:none}.gitment-container.gitment-footer-container{display:none}</style><script type="text/javascript">function renderGitment(){var e=new Gitalk({id:window.decodeURIComponent(window.location.pathname),owner:"yexiaochen",repo:"blogComments",distractionFreeMode:!1,admin:["yexiaochen"],clientSecret:"5df7f4f6edb8a65fef2d0cf7cb6fa40b04a44525",clientID:"fad749b2b67be41f767a"});e.render("gitment-container")}function showGitment(){document.getElementById("gitment-display-button").style.display="none",document.getElementById("gitment-container").style.display="block",renderGitment()}</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html><!-- rebuild by neat -->